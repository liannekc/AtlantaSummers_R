---
title: "HW4"
format: pdf
editor: visual
---

Using the 20 years of daily high temperature data for Atlanta (July through October) from Question 6.2 (file temps.txt), I built and used an exponential smoothing model to help make a judgment of whether the unofficial end of summer has gotten later over the 20 years.

------------------------------------------------------------------------

### Methodology

**First, I Ioaded any necessary libraries. Then I loaded the data and did some high level exploratory analysis. I noticed the the column header had a "x" in from of each year**

```{r}
#load data and libraries

library(tidyverse)
library(lubridate)



mydata <- read.table("temps.txt", header = TRUE, sep = "\t")
names(mydata)


```

**After examining the data, I decided to reshape the data to better analyze it. Instead of having a column for each year, I reshaped the data so that each column represents a unique data point. I did this by adding a full date column that combined the year, month and day. Before doing so, I also removed the "X" in front of the year column. I saved the new data set as temps_long**

```{r}
#reshape data to have a full yyyy-mm-dd columm to better iterate and analyze data
newdata <- mydata %>%
  pivot_longer(-DAY, names_to = "year", values_to = "tmax") %>%
  mutate(
    year = as.integer(str_replace_all(year, "\\D", "")),   # Removes X in years
    date = dmy(paste(DAY, year))
  )

head(newdata)

```

**Then to calculate the end of summer, I grouped by all temperature within a year and took the days above 85F. Then I took the latest date in that year. Lastly, the mutate function converts that hottest day into a day of the year number (what day is it out of 365), allowing for easier comparison later on in the analysis.**

```{r}
# Define "end of summer" (EOS)
eos <- newdata %>%
  group_by(year) %>%
  filter(tmax > 85) %>%                # keep only hot days
  summarize(last_hot = max(date)) %>%  # last hot day in Julâ€“Oct
  mutate(doy = yday(last_hot))


```

T**hen I created a time series using the end of summer day. Then the Holt Winters Model exponential smoothing was used, with seasonality (gamma) set to False we only have one value per year. The y Axis is the End of Summer value mapped to its respective day of the year (out of 365).**

```{r}
# Build time series of EOS
y <- ts(eos$doy, start = min(eos$year), frequency = 1)

# Fit HoltWinters model
fit_hw <- HoltWinters(y, gamma = FALSE)



# View  and plot results ---
print(fit_hw)

plot(fit_hw)


```

### Results

Based on the HoltWinters Exponential model, it seems like starting in 2005, there is a slight upward trend in End of Summer temperatures. The alpha value is 0.33 and the beta value is 0.23m

### Analysis

Since the alpha value is closer to 0, it means more weight is given to observations in the more distant past. Since the beta is greater than 0, it also means the the end of summer is trending later. The graph doesn't show a clear change in the end of summer over the past 20 years as there are a lot of fluctuations, but from 2005 onward, we can see a slight upward slop in the red line, which is inline with what we are observing with the beta.

For more accurate analysis, we would need to study a broader range of dates. Since according to the National Oceanic and Atmospheric Administration, Earth's temperature has rise by an average of 0.11F per decade since 1850, which is 2F in total.

### 
